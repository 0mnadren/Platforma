{% extends 'base_profil.html' %}

{% load crispy_forms_tags %}
{% load static %}
{% block title %}
<title>Profil</title>
{% endblock title %}

{% block content %}

<style>
    .table, th, td {
        border-color: var(--background-shadow) !important;
    }
</style>

<style>
.btn-grad {background-image: linear-gradient(to right, #314755 0%, #26a0da  51%, #314755  100%)}
.btn-grad {
   margin: 10px;
   padding: 15px 45px;
   text-align: center;
   text-transform: uppercase;
   transition: 0.5s;
   background-size: 200% auto;
   color: white;            
   box-shadow: 0 0 20px #eee;
   border-radius: 10px;
   display: block;
 }

 .btn-grad:hover {
   background-position: right center; /* change the direction of the change here */
   color: #fff;
   text-decoration: none;
 }
</style>

<h1 class="text-truncate">Profil korisnika: {{ user.username }}</h1>
<h1>Status: Recezent</h1>

<a href="{% url 'ankete:ankete' %}" class="btn-grad btn-block">Pregledaj ankete</a>
<a href="{% url 'radovi:lista_radova_profil' %}" class="btn-grad btn-block">Pregledaj RADOVe</a>
<br><br><br>
<!-- SEARCH!!! -->
<!-- U PROFILU DA IZBACI OBAVESTENJA -->
<button class="btn btn-grad btn-block" onclick="toggler('obavestenja_table');name_toggler('btn_obavestenja')"
    id="btn_obavestenja">Sakrij obavestenja</button>
<br><br>
<div id="obavestenja_table">
    <form action="{% url 'profil:search' %}" class="form-inline" method="get">
        <div class="form-group mb-8">
            <h2>{% if type %}{{ type.name }}{% else %} Pretrazi obavestenja {% endif %}</h2>
        </div>
        <div class="form-group mx-sm-3 mb-2">
            <label for="" class="sr-only">search</label>
            <input name="search" type="" class="form-control" id="" placeholder="Kljucna rec">
        </div>
        <button type="submit" class="btn btn-success btn-md mb-2">Search</button>
    </form>
    <table class="table table-striped border sortable">
        <!--sortable omogucava sort sa skripte na dnu-->
        
<thead>
    <tr>
        <th scope="col"></th>
        <th scope="col" style="max-width: 55px">Naslov</th>
        <th style="max-width: 65px;" scope="col">Sadrzaj</th>
        <th style="max-width: 65px;" scope="col">Datum</th>
        <th style="max-width: 55px; text-align: center;" scope="col">Akcija</th>
    </tr>
</thead>
<tbody>
    {% for obavestenje in obavestenja reversed %}
    <tr>
        <th scope="row" style="max-width: 20px;">{{ forloop.counter }}</th>
        <td scope="row" class="text-truncate" style="max-width: 55px"><a href="{% url 'profil:obavestenje_detaljno' pk=obavestenje.obavestenje.id %}">{{ obavestenje.obavestenje.naslov }}</a></td>
        <td data-bind="text: text()" class="text-truncate" style="max-width: 55px">{{ obavestenje.obavestenje.tekst }}</td>
        <td class="text-truncate" style="max-width: 85px">{{ obavestenje.obavestenje.datum_vreme_kreiranja }}</td>
        <td style="text-align: center;">
            <form action="{% url 'profil:obrisi_obavestenje' obavestenje.obavestenje.id %}" method="POST">
                {% csrf_token %}
                <input type="submit" value="Obrisi" class="btn btn-danger" style="padding: 2px;">
            </form>
        </td>
    </tr>
    {% endfor %}
</tbody>
    </table>

    <hr>
    <p>Nesto slicno kao postovi na profilu na fb-u</p>

</div>
<button class="btn btn-grad btn-block" onclick="toggler('user_table');name_toggler('btn_data')" id="btn_data">Prikazi
    profil</button>
<br>
<div id="user_table" style="display: none;">
    <table class="table table-bordered">
        <div class="form-group">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                {{ form|crispy }}
                <!-- 
                   form.as_table 
                    {% for field in form %}
        <div class="mt-2">
            <label class="form-label">{{ field.label }}:</label>
            <div class="col">{{ field }}</div>
            
            <div class='text-danger'>
                {{ field.errors }}
            </div>
        </div>        
        {% endfor %} -->
    </table>

    <button class="btn btn-info mt-3 mb-3 ml-lg-2" type="submit">Saƒçuvaj izmene</button>
    <button class="btn btn-info mt-3 mb-3 ml-lg-2" type='reset'>Reset izmene</button>

    </form>

</div>
</div>
</div>
<!-- SKRIPTA JS ZA SAKRIVANJE -->
<script>
    window.onload = function () {
        document.getElementById('close').onclick = function () {
            this.parentNode.parentNode.parentNode
                .removeChild(this.parentNode.parentNode);
            return false;
        };
    };
    function toggler(divId) {
        $("#" + divId).toggle()
    };
    function name_toggler(divId) {
        if (document.getElementById(divId).innerText == 'Prikazi profil') {
            document.getElementById(divId).innerText = 'Sakrij profil';
        } else if (document.getElementById(divId).innerText == 'Sakrij profil') {
            document.getElementById(divId).innerText = 'Prikazi profil';

        } else if (document.getElementById(divId).innerText == 'Prikazi obavestenja') {
            document.getElementById(divId).innerText = 'Sakrij obavestenja';
        } else if (document.getElementById(divId).innerText == 'Sakrij obavestenja') {
            document.getElementById(divId).innerText = 'Prikazi obavestenja';
        }
    };
</script>
<script src="https://www.kryogenix.org/code/browser/sorttable/sorttable.js"></script>
{% endblock content %}
